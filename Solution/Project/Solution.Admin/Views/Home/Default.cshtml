@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Js{
    <script src="@(AppGlobal.Res)js/Config.js?@AppGlobal.VNo"></script>
    <script src="@(AppGlobal.Res)js/plugins/template/template-web.js?@AppGlobal.VNo"></script>
    <script src="@(AppGlobal.Res)js/plugins/template/template.helper.js?@AppGlobal.VNo"></script>
    <script src="@(AppGlobal.Res)js/plugins/yw-jq-plugin/datagrid/datagrid-1.0.js?@AppGlobal.VNo"></script>
    <script src="@(AppGlobal.Res)js/plugins/jquery-highcharts-4.2.3/highcharts.js?@AppGlobal.VNo"></script>
    <script src="@(AppGlobal.Res)js/Admin/Home/Default.js?@AppGlobal.VNo"></script>
}

<div class="content pd5">
    <div class="container-fluid">
        @*信息提醒框*@
        <div class="callout callout-success" id="msg_div"></div>

        @*统计报表*@
        <div class="row">
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3 data-val="today_count">0</h3>
                        <p>今日订单</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="javascript:;" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3><span data-val="total_rates"></span><sup style="font-size: 20px">%</sup></h3>
                        <p>总成交率</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="javascript:;" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3 data-val="new_user_count">0</h3>
                        <p>本周注册用户</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="javascript:;" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-danger">
                    <div class="inner">
                        <h3 data-val="un_completed_order_count" >0</h3>

                        <p>未完成订单</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="javascript:;" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">订单成交概览</h5>

                        <div class="card-tools">
                            <button type="button" class="btn btn-tool" data-widget="collapse">
                                <i class="fa fa-minus"></i>
                            </button>
                            <div class="btn-group">
                                <div class="dropdown-menu dropdown-menu-right" role="menu">
                                    <a href="#" class="dropdown-item">Action</a>
                                    <a href="#" class="dropdown-item">Another action</a>
                                    <a href="#" class="dropdown-item">Something else here</a>
                                    <a class="dropdown-divider"></a>
                                    <a href="#" class="dropdown-item">Separated link</a>
                                </div>
                            </div>
                            <button type="button" class="btn btn-tool" data-widget="remove">
                                <i class="fa fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <!-- /.card-header -->
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <p class="text-center">
                                    <strong>近7日订单成交量</strong>
                                </p>

                                <div class="chart">
                                    <!-- Sales Chart Canvas -->
                                    <div id="salesChart" height="500" style="height: 187px; width: 707px;" width="1414"></div>
                                </div>
                                <!-- /.chart-responsive -->
                            </div>
                            <!-- /.col -->
                            <div class="col-md-4">
                                <p class="text-center">
                                    <strong>总订单概览</strong>
                                </p>

                                <div class="progress-group">
                                    待支付订单
                                    <span class="float-right"><b data-val="wait_pay_count" >0</b>/<span data-val="order_count"></span></span>
                                    <div class="progress progress-sm">
                                        <div class="progress-bar bg-primary" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div class="progress-group">
                                    待发货订单
                                    <span class="float-right"><b data-val="wait_delivery_count">0</b>/<span data-val="order_count"></span></span>
                                    <div class="progress progress-sm">
                                        <div class="progress-bar bg-warning" style="width: 0%"></div>
                                    </div>
                                </div>

                                <div class="progress-group">
                                    已取消订单
                                    <span class="float-right"><b data-val="cancel_order_count">0</b>/<span data-val="order_count"></span></span>
                                    <div class="progress progress-sm">
                                        <div class="progress-bar bg-danger" style="width: 0%"></div>
                                    </div>
                                </div>

                                <!-- /.progress-group -->
                                <div class="progress-group">
                                    <span class="progress-text">已完成订单</span>
                                    <span class="float-right"><b data-val="new_user_count">0</b>/<span data-val="order_count"></span></span>
                                    <div class="progress progress-sm">
                                        <div class="progress-bar bg-success" style="width: 0%"></div>
                                    </div>
                                </div>


                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->
                    </div>
                    <!-- ./card-body -->
                    <div class="card-footer">
                        <div class="row">
                            <div class="col-sm-3 col-6">
                                <div class="description-block border-right">
                                    <span class="description-percentage text-success"><i class="fa fa-caret-up"></i> <span data-valr="this_month_amountr">0</span>%</span>
                                    <h5 class="description-header" data-val="this_month_disamount" format-money="2" money-symbol="￥">0</h5>
                                    <span class="description-text">当月订单总额</span>
                                </div>
                                <!-- /.description-block -->
                            </div>
                            <!-- /.col -->
                            <div class="col-sm-3 col-6">
                                <div class="description-block border-right">
                                    <span class="description-percentage text-success"><i class="fa fa-caret-up"></i> <span data-valr="this_month_disamountr">0</span>%</span>
                                    <h5 class="description-header" data-val="this_month_disamount" format-money="2" money-symbol="￥">0</h5>
                                    <span class="description-text">当月订单总折扣</span>
                                </div>
                                <!-- /.description-block -->
                            </div>
                            <!-- /.col -->
                            <div class="col-sm-3 col-6">
                                <div class="description-block border-right">
                                    <span class="description-percentage text-success"><i class="fa fa-caret-up"></i> <span data-valr="this_month_couamountr">0</span>%</span>
                                    <h5 class="description-header" data-val="this_month_couamount" format-money="2" money-symbol="￥">0</h5>
                                    <span class="description-text">当月优惠卷总额</span>
                                </div>
                                <!-- /.description-block -->
                            </div>
                            <!-- /.col -->
                            <div class="col-sm-3 col-6">
                                <div class="description-block">
                                    <span class="description-percentage text-success"><i class="fa fa-caret-up"></i> <span data-valr="this_month_famountr">0</span>%</span>
                                    <h5 class="description-header" data-val="this_month_famount" format-money="2" money-symbol="￥">1200</h5>
                                    <span class="description-text">当月运费总金额</span>
                                </div>
                                <!-- /.description-block -->
                            </div>
                        </div>
                        <!-- /.row -->
                    </div>
                    <!-- /.card-footer -->
                </div>
                <!-- /.card -->
            </div>
            <!-- /.col -->
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">近三天提交的订单</h5>

                        <div class="card-tools">
                            <button type="button" class="btn btn-tool" data-widget="collapse">
                                <i class="fa fa-minus"></i>
                            </button>
                            <div class="btn-group"> 
                                <div class="dropdown-menu dropdown-menu-right" role="menu">
                                    <a href="#" class="dropdown-item">Action</a>
                                    <a href="#" class="dropdown-item">Another action</a>
                                    <a href="#" class="dropdown-item">Something else here</a>
                                    <a class="dropdown-divider"></a>
                                    <a href="#" class="dropdown-item">Separated link</a>
                                </div>
                            </div>
                            <button type="button" class="btn btn-tool" data-widget="remove">
                                <i class="fa fa-times"></i>
                            </button>
                        </div>
                    </div>

                    @*订单列表*@
                    <div name="datagrid"></div>

                    <div class="card-footer">
                        <div class="row">
                        </div>
                        <!-- /.row -->
                    </div>
                </div>
                <!-- /.card -->
            </div>
            <!-- /.col -->
        </div>
    </div>

    @*订单数据模板*@
    <script type="text/html" id="template">
        {{each data as obj i}}
        <tr data-id="{{obj.id}}">
            <td>
                <span style="color:blue;">{{obj.serial_no}}</span>
            </td>
            <td>
                {{if obj.is_cod}}
                <p style="color:red;">货到付款</p>
                {{/if}}
                <p>{{GetOrderStatus(obj.status)}}</p>
            </td>
            <td><span style="color: red;">￥{{obj.actual_amount | formaToMoney}}</span></td>
            <td>
                {{obj.created_date | ChangeCompleteDateFormat}}
            </td>
            <td>
                {{if obj.delivery != null }}
                {{obj.delivery.contact}} {{obj.delivery.mobile}}<br />
                {{obj.delivery.province}} {{obj.delivery.city}} {{obj.delivery.area}} {{obj.delivery.address}}
                {{/if}}
                <p>
                    {{if obj.remarks == "" || obj.remarks == null}}
                    --
                    {{else}}
                    {{obj.remarks}}
                    {{/if}}
                </p>
            </td>
        </tr>
        {{/each}}
    </script>

    @*消息提醒模板*@
    <script type="text/html" id="template_msg">
        {{each data as obj i}}
        <h5>{{obj.title}}</h5>
        <p>{{obj.msg}}</p>
        {{/each}}
    </script>
</div>

